// ë¹„ë™ê¸° JS í”„ë¡œê·¸ë¨ì˜ ê¸°ë³¸ ë‹¨ìœ„ëŠ” ì½œë°±ì´ë‹¤.
// ë‹¤ë¥¸ í•¨ìˆ˜ì— ì „ë‹¬ë˜ëŠ” í•¨ìˆ˜ê°€ ì½œë°±

// ë¹„ë™ê¸° í•¨ìˆ˜ê°€ í˜¸ì¶œí•˜ëŠ” ì½œë°± í•¨ìˆ˜ëŠ” ì¼ë°˜ì ì¸ í•¨ìˆ˜ì´ê¸° ë•Œë¬¸ì— íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ë¡œ ë¹„ë™ê¸°ì„ì„ ì•Œë¦¬ëŠ” ì‹œê·¸ë‹ˆì²˜ëŠ” ì¡´ì¬í•˜ì§€ ì•ŠìŒ

// ğŸ”¥ ì½œë°±ì§€ì˜¥
// ë¹„ë™ê¸° ì²˜ë¦¬ ë¡œì§ì„ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰í•˜ê¸° ìœ„í•´ ì½œë°± í•¨ìˆ˜ë¥¼ ê³„ì† ì¤‘ì²©í•˜ì—¬ ì‚¬ìš©í•  ë•Œ ë°œìƒí•˜ëŠ” ë¬¸ì œë¥¼ ì½œë°± ì§€ì˜¥ì´ë¼ê³  ë¶€ë¥¸ë‹¤.
// ì½”ë“œì˜ ê°€ë…ì„± ë° ì—ëŸ¬ ì²˜ë¦¬ ë“±ì˜ ë¡œì§ì´ ë³µì¡í•´ì§„ë‹¤ëŠ” ë¬¸ì œê°€ ìˆë‹¤.

// srcì— ìˆëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì½ì–´ì˜¤ëŠ” í•¨ìˆ˜
function loadScript1(src: string) {
  const script = document.createElement('script');
  script.src = src;
  document.head.append(script);
}

loadScript1('script.ts');

// ìœ„ loadScript í•¨ìˆ˜ëŠ” ë¹„ë™ê¸° ë™ì‘ì„ í•˜ëŠ” í•¨ìˆ˜ì´ê¸° ë•Œë¬¸ì— ë¡œë“œê°€ ì™„ë£Œëœ ì‹œì ì— ì–´ë– í•œ ì‘ì—…ì„ í•˜ê³  ì‹¶ì–´ë„ í•  ìˆ˜ ì—†ë‹¤.
// ë˜ ë¡œë“œí•˜ëŠ” ê²ƒì„ ê¸°ë‹¤ë¦¬ì§€ ì•Šê¸° ë•Œë¬¸ì— ë¶ˆëŸ¬ì˜¤ëŠ” ìŠ¤í¬ë¦½íŠ¸ ì•ˆì˜ í•¨ìˆ˜ë‚˜ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê¸° ê³¤ë€í•˜ë‹¤.

// ìŠ¤í¬ë¦½íŠ¸ì˜ ë¡œë”©ì´ ëë‚˜ë©´ ì‹¤í–‰ë  ì½œë°± í•¨ìˆ˜ë¥¼ ì¸ìë¡œ ë°›ì•„ ì´ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.

function loadScript2(
  src: string,
  callback: (script: HTMLScriptElement) => void
) {
  // <script> íƒœê·¸ë¥¼ ë§Œë“¤ê³  í˜ì´ì§€ì— íƒœê·¸ë¥¼ ì¶”ê°€
  // íƒœê·¸ê°€ í˜ì´ì§€ì— ì¶”ê°€ë˜ë©´ srcì— ìˆëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¡œë”©í•˜ê³  ì‹¤í–‰
  const script = document.createElement('script');
  script.src = src;

  // ìŠ¤í¬ë¦½íŠ¸ ë¡œë”©ì´ ëë‚˜ë©´ ì‹¤í–‰ë  ì½œë°± í•¨ìˆ˜
  script.onload = () => callback(script);
  document.head.append(script);
}

loadScript2(
  'https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.2.0/lodash.js',
  script => {
    alert(`${script.src}ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.`);
  }
);
// ë§Œì•½ ìŠ¤í¬ë¦½íŠ¸ê°€ ì—¬ëŸ¬ ê°œ ì¡´ì¬í•˜ëŠ” ê²½ìš° ì´ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ë¶ˆëŸ¬ì˜¤ë ¤ë©´?
// ì½œë°± í•¨ìˆ˜ ë‚´ë¶€ì— í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ê³ , ë˜ ì‹¤í–‰í•˜ê³  ì‹¤í–‰í•˜ê³ ..
// ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•˜ê¸° ê³¤ë€í•  ë¿ë”ëŸ¬ ì½œë°±ì„ ì²˜ë¦¬í•˜ëŠ” ë¡œì§ì„ ì•Œì•„ë³´ê¸°ë„ ì–´ë µë‹¤.

// ì—ëŸ¬ í•¸ë“¤ë§
function loadScript3(
  src: string,
  callback: (error: Error | null, script?: HTMLScriptElement) => void
) {
  // <script> íƒœê·¸ë¥¼ ë§Œë“¤ê³  í˜ì´ì§€ì— íƒœê·¸ë¥¼ ì¶”ê°€
  // íƒœê·¸ê°€ í˜ì´ì§€ì— ì¶”ê°€ë˜ë©´ srcì— ìˆëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¡œë”©í•˜ê³  ì‹¤í–‰
  const script = document.createElement('script');
  script.src = src;

  // ìŠ¤í¬ë¦½íŠ¸ ë¡œë”©ì´ ëë‚˜ë©´ ì‹¤í–‰ë  ì½œë°± í•¨ìˆ˜
  script.onload = () => callback(null, script);
  script.onerror = () =>
    callback(new Error(`${src}ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë„ì¤‘ ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`));

  document.head.append(script);
}

function handleError(error: Error) {}

loadScript3('1.js', function (error, script) {
  if (error) {
    handleError(error);
  } else {
    // ...
    loadScript3('2.js', function (error, script) {
      if (error) {
        handleError(error);
      } else {
        // ...
        loadScript3('3.js', function (error, script) {
          if (error) {
            handleError(error);
          } else {
            // ëª¨ë“  ìŠ¤í¬ë¦½íŠ¸ê°€ ë¡œë”©ëœ í›„, ì‹¤í–‰ íë¦„ì´ ì´ì–´ì§
          }
        });
      }
    });
  }
});

// ì—¬ëŸ¬ ê°œì˜ ë¹„ë™ê¸° ì‘ì—…ì„ ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œ ì½œë°± í•¨ìˆ˜ê°€ ì½œë°± í•¨ìˆ˜ì˜ ê¼¬ë¦¬ë¥¼ ë¬´ëŠ” í˜•íƒœê°€ ê³„ì†ë˜ëŠ” ê²ƒì„ ì½œë°± ì§€ì˜¥
// ê°„ë‹¨í•œ ë¹„ë™ê¸° ì‘ì—…ì€ ì½œë°± í•¨ìˆ˜ë¥¼ í†µí•´ ì²˜ë¦¬í•´ë„ ë¬¸ì œê°€ ë˜ì§€ ì•Šê² ì§€ë§Œ, ë¹„ë™ê¸° ì‘ì—…ì´ ì—¬ëŸ¬ ê°œë¡œ ëŠ˜ì–´ë‚˜ë©´ ê¸ˆë°© ë³µì¡í•´ì§„ë‹¤.
